name: Vitest

on:
  push:
    branches: [main, master]
  pull_request:
    branches: [main, master]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'

    - name: Install dependencies
      run: npm ci

    - name: Run ESLint
      run: npm run lint

    - name: Run Vitest
      run: npx vitest run
    
    # - name: Deploy to Vercel (Production)
    #   if: github.event_name == 'push'
    #   env:
    #     VERCEL_TOKEN: ${{ 2oOMLQap4zgObnLjzkNW23Gr }}
    #     VERCEL_ORG_ID: ${{ team_KL82Xh4lhrzVsaoRDYF5Qp4H }}
    #     VERCEL_PROJECT_ID: ${{ prj_1XChNgZJ1A4nbAO5o7cGK5wIoR42}}
    #   run: |
    #     npm install --global vercel
    #     vercel pull --yes --environment=production --token=$VERCEL_TOKEN
    #     vercel build --prod --token=$VERCEL_TOKEN
    #     vercel deploy --prebuilt --prod --token=$VERCEL_TOKEN
